<Window x:Class="OrderWatch.Views.TradeHistoryWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="äº¤æ˜“åŽ†å²è®°å½•" Height="700" Width="1200"
        WindowStartupLocation="CenterScreen">
    
    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- æ ‡é¢˜ -->
        <TextBlock Grid.Row="0" Text="äº¤æ˜“åŽ†å²è®°å½•" FontSize="20" FontWeight="Bold" 
                   Margin="0,0,0,20" Foreground="#2196F3"/>

        <!-- æŸ¥è¯¢æ¡ä»¶ -->
        <Border Grid.Row="1" BorderBrush="#E0E0E0" BorderThickness="1" 
                CornerRadius="5" Padding="15" Margin="0,0,0,15" Background="White">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <TextBlock Grid.Column="0" Text="å¼€å§‹æ—¥æœŸ:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                <DatePicker Grid.Column="1" x:Name="StartDatePicker" SelectedDate="{Binding StartDate}" 
                           Width="120" Margin="0,0,15,0"/>

                <TextBlock Grid.Column="2" Text="ç»“æŸæ—¥æœŸ:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                <DatePicker Grid.Column="3" x:Name="EndDatePicker" SelectedDate="{Binding EndDate}" 
                           Width="120" Margin="0,0,15,0"/>

                <TextBlock Grid.Column="4" Text="åˆçº¦:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                <TextBox Grid.Column="5" Text="{Binding FilterSymbol, UpdateSourceTrigger=PropertyChanged}" 
                        Width="100" Margin="0,0,15,0" ToolTip="ç•™ç©ºè¡¨ç¤ºæŸ¥è¯¢æ‰€æœ‰åˆçº¦"/>

                <Button Grid.Column="6" Content="ðŸ” æŸ¥è¯¢" Command="{Binding QueryCommand}" 
                       Width="80" Height="30" Background="#4CAF50" Foreground="White" 
                       FontWeight="Bold" Margin="0,0,0,0"/>
            </Grid>
        </Border>

        <!-- åŽ†å²è®°å½•åˆ—è¡¨ -->
        <DataGrid Grid.Row="2" x:Name="HistoryDataGrid" 
                  ItemsSource="{Binding TradeHistories}"
                  SelectedItem="{Binding SelectedTradeHistory}"
                  AutoGenerateColumns="False"
                  IsReadOnly="True"
                  GridLinesVisibility="Horizontal"
                  HeadersVisibility="Column"
                  CanUserResizeRows="False"
                  CanUserAddRows="False"
                  CanUserDeleteRows="False"
                  SelectionMode="Single"
                  SelectionUnit="FullRow">
            
            <DataGrid.Columns>
                <DataGridTextColumn Header="æ—¶é—´" Binding="{Binding FormattedTimestamp}" Width="150"/>
                <DataGridTextColumn Header="åˆçº¦" Binding="{Binding Symbol}" Width="80"/>
                <DataGridTextColumn Header="æ“ä½œ" Binding="{Binding Action}" Width="120"/>
                <DataGridTextColumn Header="ä»·æ ¼" Binding="{Binding FormattedPrice}" Width="80"/>
                <DataGridTextColumn Header="æ•°é‡" Binding="{Binding FormattedQuantity}" Width="80"/>
                <DataGridTextColumn Header="ç»“æžœ" Binding="{Binding Result}" Width="60"/>
                <DataGridTextColumn Header="è®¢å•ç±»åž‹" Binding="{Binding FormattedOrderType}" Width="80"/>
                <DataGridTextColumn Header="æ–¹å‘" Binding="{Binding FormattedSide}" Width="60"/>
                <DataGridTextColumn Header="æ æ†" Binding="{Binding FormattedLeverage}" Width="60"/>
                <DataGridTextColumn Header="åˆ†ç±»" Binding="{Binding Category}" Width="80"/>
                <DataGridTextColumn Header="è¯¦æƒ…" Binding="{Binding Details}" Width="200"/>
            </DataGrid.Columns>

            <DataGrid.RowStyle>
                <Style TargetType="DataGridRow">
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding Result}" Value="æˆåŠŸ">
                            <Setter Property="Background" Value="#E8F5E8"/>
                        </DataTrigger>
                        <DataTrigger Binding="{Binding Result}" Value="å¤±è´¥">
                            <Setter Property="Background" Value="#FFEBEE"/>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </DataGrid.RowStyle>
        </DataGrid>

        <!-- åº•éƒ¨æ“ä½œæ  -->
        <Border Grid.Row="3" BorderBrush="#E0E0E0" BorderThickness="1" 
                CornerRadius="5" Padding="15" Margin="0,15,0,0" Background="White">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <TextBlock Grid.Column="0" Text="{Binding StatusMessage}" VerticalAlignment="Center" 
                           Foreground="#666" FontStyle="Italic"/>

                <Button Grid.Column="1" Content="ðŸ“Š å¯¼å‡ºCSV" Command="{Binding ExportCsvCommand}" 
                       Width="100" Height="30" Background="#FF9800" Foreground="White" 
                       FontWeight="Bold" Margin="0,0,10,0"/>

                <Button Grid.Column="2" Content="ðŸ”„ åˆ·æ–°" Command="{Binding RefreshCommand}" 
                       Width="80" Height="30" Background="#2196F3" Foreground="White" 
                       FontWeight="Bold" Margin="0,0,10,0"/>

                <Button Grid.Column="3" Content="âŒ å…³é—­" Click="CloseButton_Click" 
                       Width="80" Height="30" Background="#F44336" Foreground="White" 
                       FontWeight="Bold"/>
            </Grid>
        </Border>
    </Grid>
</Window>
